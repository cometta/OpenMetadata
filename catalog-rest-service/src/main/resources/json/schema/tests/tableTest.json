{
  "$id": "https://open-metadata.org/schema/tests/tableTest.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "TableTest",
  "description": "TableTest is a test definition to capture data quality tests against tables and columns.",
  "type": "object",
  "definitions": {
    "testCase": {
      "description": "Table Test Case.",
      "type": "object",
      "properties": {
        "config": {
          "oneOf": [
            { "$ref": "./table/tableRowCountToEqual.json" },
            { "$ref": "./table/tableRowCountToBeBetween.json" },
            { "$ref": "./table/tableColumnCountToEqual.json" },
            { "$ref": "./column/columnValuesToBeUnique.json" },
            { "$ref": "./column/columnValuesToBeNotNull.json" },
            { "$ref": "./column/columnValuesToMatchRegex.json" },
            { "$ref": "./column/columnValuesToBeNotInSet.json" },
            { "$ref": "./column/columnValuesToBeBetween.json" },
            { "$ref": "./column/columnValuesMissingCountToBeEqual.json" },
            { "$ref": "./column/columnValueLengthsToBeBetween.json" }
          ]
        },
        "schema": {
          "enum": [
            "tableRowCountToEqual",
            "tableRowCountToBeBetween",
            "tableColumnCountToEqual",
            "columnValueToBeUnique",
            "columnValuesToBeNotNull",
            "columnValuesToMatchRegex",
            "columnValuesToBeNotInSet",
            "columnValuesToBeBetween",
            "columnValuesMissingCountToBeEqual",
            "columnValueLengthsToBeBetween"
          ]
        }
      },
      "additionalProperties": false
    },
    "testCaseExecutionFrequency": {
      "description": "How often the test case should run.",
      "javaType": "org.openmetadata.catalog.type.TestCaseExecutionFrequency",
      "type": "string",
      "enum": ["Hourly", "Daily", "Weekly"],
      "javaEnums": [
        {
          "name": "Hourly"
        },
        {
          "name": "Daily"
        },
        {
          "name": "Weekly"
        }
      ]
    },
    "testCaseResult": {
      "executionTime": {
        "description": "Data one which profile is taken.",
        "$ref": "../type/basic.json#/definitions/timestamp"
      },
      "status": {
        "description": "Status of Test Case run.",
        "javaType": "org.openmetadata.catalog.type.TestCaseStatus",
        "type": "string",
        "enum": ["Success", "Failed", "Aborted"],
        "javaEnums": [
          {
            "name": "Success"
          },
          {
            "name": "Failed"
          },
          {
            "name": "Aborted"
          }
        ]
      },
      "result": {
        "description": "Details of test case results.",
        "type": "string"
      },
      "sampleData": {
        "description": "sample data to capture rows/columns that didn't match the expressed testcase.",
        "type": "string"
      }
    }
  },
  "properties": {
    "id": {
      "description": "Unique identifier of this table instance.",
      "$ref": "../type/basic.json#/definitions/uuid"
    },
    "name": {
      "description": "Name that identifies this test case.",
      "type": "string",
      "minLength": 1,
      "maxLength": 128
    },
    "description": {
      "description": "Description of the testcase.",
      "type": "string"
    },
    "testCase": {
      "$ref": "#/definitions/testCase"
    },
    "executionFrequency": {
      "$ref": "#/definitions/testCaseExecutionFrequency"
    },
    "results": {
      "description": "List of results of the test case.",
      "type": "array",
      "items": {
        "$ref": "#/definitions/testCaseResult"
      }
    },
    "owner": {
      "description": "Owner of this Pipeline.",
      "$ref": "../type/entityReference.json",
      "default": null
    },
    "updatedAt": {
      "description": "Last update time corresponding to the new version of the entity in Unix epoch time milliseconds.",
      "$ref": "../type/basic.json#/definitions/timestamp"
    },
    "updatedBy": {
      "description": "User who made the update.",
      "type": "string"
    },
    "deleted": {
      "description": "When `true` indicates the entity has been soft deleted.",
      "type": "boolean",
      "default": false
    }
  },
  "required": ["name", "testCase"],
  "additionalProperties": false
}
